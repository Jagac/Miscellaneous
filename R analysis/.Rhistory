x <- 15
x <- 13
print("Hello World!")
getwd()
setwd("C:/Users/Jagos/Documents/ECON 380/R analysis")
getwd()
library(tidyverse)
library(Hmisc)
library(statip)
library(stargazer)
library(coefplot)
library(jtools)
library(sandwich)
library(ggstance)
library(broom.mixed)
library(huxtable)
library(plyr)
library(plm)
library(corrplot)
library(zoo)
library(lmtest)
library(plm)
library(readxl)
library(writexl)
library(ggthemes)
migr <- read.csv("immigration.csv")
pat <- read.csv("patents.csv")
rnd <- read.csv('r&d.csv')
pop <- read.csv('pop.csv')
popden <- read.csv('pop_dens.csv')
hrst <- read.csv('HRST.csv')
tranvol <- read.csv('tranvol.csv')
httrade <- read.csv("httrade.csv")
inFDI <- read.csv("InFDI.csv")
httex <- read.csv("httex.csv")
gdp <- read.csv("gdp.csv")
gdpcap <- read.csv("gdpcap.csv")
emp <- read.csv("emp.csv")
#master <- read_excel('master.xlsx')
#inc <- read.csv('earn.csv')
#df <- read_excel("df.xlsx")
#inc <- select(inc, -DATAFLOW, -LAST.UPDATE, -freq, -OBS_FLAG, -nace_r2, -isco08, -worktime, -age, -indic_se, -sex)
#inc <- dplyr::rename(inc, inc = OBS_VALUE)
emp <- select(emp,-DATAFLOW, -LAST.UPDATE, -freq, -OBS_FLAG, -nace_r2, -unit, -indic_sb)
emp <- dplyr::rename(emp, emp = OBS_VALUE)
gdpcap <-subset(gdpcap, gdpcap$geo != "EU27_2020" & gdpcap$geo != "EU27_2007")
gdpcap <- select(gdpcap,-DATAFLOW, -LAST.UPDATE, -freq, -OBS_FLAG, -na_item, -ppp_cat)
gdpcap <- dplyr::rename(gdpcap, gdpcap = OBS_VALUE)
gdp <- subset(gdp, gdp$unit != "CP_EUR_HAB" & gdp$geo != "EA19" & gdp$unit != "CP_MEUR")
gdp <- select(gdp, -DATAFLOW, -LAST.UPDATE, -freq, -unit, -OBS_FLAG, -na_item)
gdp <- dplyr::rename(gdp, gdp = OBS_VALUE)
httex <- select(httex, -DATAFLOW, -LAST.UPDATE, -freq, -unit, -OBS_FLAG)
httex <- dplyr::rename(httex, httex = OBS_VALUE)
inFDI <- select(inFDI, -DATAFLOW, -LAST.UPDATE, -freq, -OBS_FLAG, -entity, -indic_bp,-fdi_item,-partner)
inFDI <- dplyr::rename(inFDI, inFDI = OBS_VALUE)
migr <- subset(migr, migr$agedef != "REACH")
migr <- select(migr, -DATAFLOW,-LAST.UPDATE,-age,-agedef, -citizen, -sex,-unit,-OBS_FLAG,-freq,)
migr <- dplyr::rename(migr, migr = OBS_VALUE)
httrade <- subset(httrade, httrade$unit != "PC_TOT" & httrade$partner != "EXT_EU28"
& httrade$partner != "INT_EU28" & httrade$stk_flow != "EXP")
httrade <- select(httrade, -DATAFLOW,-LAST.UPDATE,-freq,-stk_flow,-unit,-OBS_FLAG,-partner)
httrade <- dplyr::rename(httrade, httrade = OBS_VALUE)
pat <- subset(pat, pat$unit != "P_MHAB")
pat <- select(pat,-DATAFLOW,-LAST.UPDATE,-OBS_FLAG,-freq,-unit)
pat <- dplyr::rename(pat, pat = OBS_VALUE)
rnd <- subset(rnd, rnd$sectperf != 'GOV' & rnd$sectperf != 'HES' & rnd$sectperf != 'PNP' & rnd$sectperf != 'BES')
rnd <- select(rnd,-DATAFLOW,-LAST.UPDATE,-freq,-OBS_FLAG,-sectperf,-unit)
rnd <- dplyr::rename(rnd, rnd = OBS_VALUE)
hrst <- select(hrst,-DATAFLOW,-LAST.UPDATE,-OBS_FLAG,-unit,-age,-category,-freq,-sex)
hrst <- dplyr::rename(hrst, hrst = OBS_VALUE)
pop <- select(pop, -DATAFLOW,-LAST.UPDATE,-OBS_FLAG,-indic_de,-freq)
pop <- dplyr::rename(pop, pop = OBS_VALUE)
popden <- select(popden,-DATAFLOW,-LAST.UPDATE,-OBS_FLAG,-unit,-freq)
popden <- dplyr::rename(popden, popden = OBS_VALUE)
tranvol <- select(tranvol,-DATAFLOW,-LAST.UPDATE,-OBS_FLAG,-freq,-unit)
tranvol <- dplyr::rename(tranvol, tranvol = OBS_VALUE)
data <- merge(pat, migr, by=c("geo", "TIME_PERIOD"), all.x=TRUE)
data2 <- merge(data, emp, by=c("geo", "TIME_PERIOD"), all.x=TRUE)
data3 <- merge(data2, gdp, by=c("geo", "TIME_PERIOD"), all.x=TRUE)
data4 <- merge(data3, gdpcap, by=c("geo", "TIME_PERIOD"), all.x=TRUE)
data5 <- merge(data4, httex, by=c("geo", "TIME_PERIOD"), all.x=TRUE)
data6 <- merge(data5, httrade, by=c("geo", "TIME_PERIOD"), all.x=TRUE)
data7 <- merge(data6, inFDI, by=c("geo", "TIME_PERIOD"), all.x=TRUE)
data8 <- merge(data7, pop, by=c("geo", "TIME_PERIOD"), all.x=TRUE)
data9 <- merge(data8, popden, by=c("geo", "TIME_PERIOD"), all.x=TRUE)
data10 <- merge(data9, rnd, by=c("geo", "TIME_PERIOD"), all.x=TRUE)
data11 <- merge(data10, tranvol, by=c("geo", "TIME_PERIOD"), all.x=TRUE)
df <- data11
df <- subset(df, df$geo != "EU27_2020" & df$geo != "EU28" & df$geo != "IL" & df$geo != "IN" & df$geo != "KR" &
df$geo != "SG" & df$geo != "US" & df$geo != "ZA" & df$geo != "AU" & df$geo != "BR" & df$geo != "CA" &
df$geo !=  "CN_X_HK" & df$geo !=  "HK" & df$geo !=  "JP" &
df$geo !=  "TW" & df$geo !=  "MX" & df$geo !=  "NZ" )
df <- dplyr::rename(df, country = geo)
df <- dplyr::rename(df, year = TIME_PERIOD)
df <- dplyr::rename(df, httim = httrade)
summary(df)
ggplot(df, aes(x=pat)) + geom_histogram(color="black", fill="lightblue", bins=55)+theme_stata()+
ggtitle("Histogram of Number Patent Applications")+
labs(y="Frequency", x = "Number of Patents")+ xlim(7500)
ggplot(df, aes(x=pat)) + geom_histogram(color="black", fill="lightblue", bins=55)+theme_stata()+
ggtitle("Histogram of Number Patent Applications")+
labs(y="Frequency", x = "Number of Patents")+ xlim(0,7500)
mfv(df$pat)
ggplot(df, aes(x=pat)) + geom_histogram(color="black", fill="lightblue", bins=55)+theme_stata()+
ggtitle("Histogram of Number Patent Applications")+
labs(y="Frequency", x = "Number of Patents")+ xlim(0,6000)
ggplot(df, aes(x=migr)) + geom_histogram(color="black", fill="lightblue", bins=55)+theme_stata()+
ggtitle("Histogram of Number of Immigrants")+
labs(y="Frequency", x = "Number of Immigrants")+ xlim(0,750000)
m1 <- lm(pat~migr, df)
m2 <- lm(pat~migr+rnd, df)
m3 <- lm(pat~migr+rnd+pop, df)
m4 <- lm(pat~migr+rnd+pop+popden, df)
m5 <- lm(pat~migr+rnd+pop+popden+tranvol, df)
m6 <- lm(pat~migr+rnd+pop+popden+tranvol+httrade, df)
m7 <- lm(pat~migr+rnd+pop+popden+tranvol+httrade, df)
m8 <- lm(pat~migr+rnd+pop+popden+tranvol+httrade+gdp, df)
m9 <- lm(pat~migr+rnd+pop+popden+tranvol+httrade+gdp+gdpcap, df)
m10 <- lm(pat~migr+rnd+pop+popden+tranvol+httrade+gdp+gdpcap+httex, df)
m11 <- lm(pat~migr+rnd+pop+popden+tranvol+httrade+gdp+gdpcap+httex+emp, df)
m12 <- lm(pat~migr+rnd+pop+popden+tranvol+httrade+gdp+gdpcap+httex+emp+inFDI, df)
m1 <- lm(pat~migr, df)
m2 <- lm(pat~migr+rnd, df)
m3 <- lm(pat~migr+rnd+pop, df)
m4 <- lm(pat~migr+rnd+pop+popden, df)
m5 <- lm(pat~migr+rnd+pop+popden+tranvol, df)
m6 <- lm(pat~migr+rnd+pop+popden+tranvol+httim, df)
m7 <- lm(pat~migr+rnd+pop+popden+tranvol+httim, df)
m8 <- lm(pat~migr+rnd+pop+popden+tranvol+httim+gdp, df)
m9 <- lm(pat~migr+rnd+pop+popden+tranvol+httim+gdp+gdpcap, df)
m10 <- lm(pat~migr+rnd+pop+popden+tranvol+httim+gdp+gdpcap+httex, df)
m11 <- lm(pat~migr+rnd+pop+popden+tranvol+httim+gdp+gdpcap+httex+emp, df)
m12 <- lm(pat~migr+rnd+pop+popden+tranvol+httim+gdp+gdpcap+httex+emp+inFDI, df)
stargazer(m1,m2,m3,m4,m5,m6,m7,m8,m9,m10,m11,m12, title="OLS Regression Results", align=TRUE, type="text", out="text_results.txt")
